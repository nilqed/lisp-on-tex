\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{lmodern}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\usepackage{framed}
\usepackage{lisp-on-tex}
\input{listfun.sty}
\author{Kurt Pagani}
\title{Test listfun.sty}
\begin{document}
\maketitle
\tableofcontents

\section{Standard functions}

\subsection{writeList}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \writeList \lst \b \sep \e 
%%% -- \lst .......... the list to display
%%% -- \b   .......... the begin character, e.g. '['
%%% -- \sep .......... the separator, e.g. ', '
%%% -- \e   .......... then end character, e.g. ']'
%%% Writes out a list in the form specified.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
(\define \lstA (\list 'a' 'b' '$\delta$' :12 '$\pi$'))
(\define \lstB (\list '\LaTeX' (\list '$\frac{\xi}{\Omega}$' :999) '$\partial\Gamma$'))
%
(\texprint '\begin{center}')
(\writeList \lstA '[' ', ' ']')
(\texprint '\end{center}')
%
(\texprint '\begin{center}')
(\writeList \lstB '[' ', ' ']')
(\texprint '\end{center}') 
%
(\texprint '\begin{center}')
(\writeList \lstA '(' ' ' ')')
(\texprint '\end{center}')
%
(\texprint '\begin{center}')
(\writeList \lstB '\{' ' :: ' '\}')
(\texprint '\end{center}')
\end{verbatim}

\begin{framed}
\lispinterp{%
(\define \lstA (\list 'a' 'b' '$\delta$' :12 '$\pi$'))
(\define \lstB (\list '\LaTeX' (\list '$\frac{\xi}{\Omega}$' :999) '$\partial\Gamma$'))
%
(\texprint '\begin{center}')
(\writeList \lstA '[' ', ' ']')
(\texprint '\end{center}')
%
(\texprint '\begin{center}')
(\writeList \lstB '[' ', ' ']')
(\texprint '\end{center}')
%
(\texprint '\begin{center}')
(\writeList \lstA '(' ' ' ')')
(\texprint '\end{center}')
%
(\texprint '\begin{center}')
(\writeList \lstB '\{' ' :: ' '\}')
(\texprint '\end{center}')
}
\end{framed}

\subsection{equalQ}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \equalQ \x \y
%%% -- \x, \y any lisp type
%%% Tests equality recursively.
%%% Note that atomQ () -> /f, i.e () is not an atom.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(\print (\equalQ (\list) ()))
(\print (\equalQ \lstA \lstB))
(\print (\equalQ \lstA \lstA))
(\print (\equalQ \lstB \lstB))
(\print (\equalQ :123 :123))
(\print (\equalQ :0 :-0))
(\print (\equalQ '$\alpha$' '$\alpha$'))
(\print (\equalQ 'A' 'a'))
\end{verbatim}

\begin{framed}
\lispinterp{
(\print (\equalQ (\list) ()))
(\print (\equalQ \lstA \lstB))
(\print (\equalQ \lstA \lstA))
(\print (\equalQ \lstB \lstB))
(\print (\equalQ :123 :123))
(\print (\equalQ :0 :-0))
(\print (\equalQ '$\alpha$' '$\alpha$'))
(\print (\equalQ 'A' 'a'))
}
\end{framed}

\subsection{atomOrNilQ}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \atomOrNilQ \x
%%% Check whether \x is an atom or the empty list (). Returns /f otherwise.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(\print (\atomQ () ))
(\print (\nilQ () ))
(\print (\atomOrNilQ () ))
(\print (\atomOrNilQ :1222))
(\print (\atomOrNilQ 'string'))
(\print (\atomOrNilQ \lstA))
\end{verbatim}

\begin{framed}
\lispinterp{
(\print (\atomQ () ))
(\print (\nilQ () ))
(\print (\atomOrNilQ () ))
(\print (\atomOrNilQ :1222))
(\print (\atomOrNilQ 'string'))
(\print (\atomOrNilQ \lstA))
}
\end{framed}

\subsection{append}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \append \x \y
%%% Append \y to the list \x.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(\define \lstAB (\append \lstA \lstB))
(\writeList \lstAB '(' ', ' ')')
(\texprint '\\') % newline
(\writeList (\append \lstA (\list 'the end of the list')) '[' ', ' ']')
\end{verbatim}

\begin{framed}
\noindent
\lispinterp{
(\define \lstAB (\append \lstA \lstB))
(\writeList \lstAB '(' ', ' ')')
(\texprint '\\') % newline
(\writeList (\append \lstA (\list 'the end of the list')) '[' ', ' ']')
}
\end{framed}

\subsection{subst}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \subst \x \y \z
%%% Substitute \x for \y in the list \z.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(\writeList (\subst '\copyright' '\LaTeX' \lstAB ) '[' ', ' ']')
(\texprint '\\') % newline
(\writeList (\subst 'nine' :999 \lstAB ) '[' ', ' ']')
(\texprint '\\') % newline
(\writeList (\subst (\list :1 :2 'Z') :999 \lstAB ) '[' ', ' ']')
\end{verbatim}

\begin{framed}
\noindent
\lispinterp{
(\writeList (\subst '\copyright' '\LaTeX' \lstAB ) '[' ', ' ']')
(\texprint '\\') % newline
(\writeList (\subst 'nine' :999 \lstAB ) '[' ', ' ']')
(\texprint '\\') % newline
(\writeList (\subst (\list :1 :2 'Z') :999 \lstAB ) '[' ', ' ']')
}
\end{framed}

\subsection{memberQ}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \memberQ \x \y
%%% If \x is a member of \y then return /t else /f. 
%%% Note: \x may be a sublist, and atoms are members only on first level!
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(\print (\memberQ '\LaTeX' \lstAB))
(\print (\memberQ :999 \lstAB))
(\print (\memberQ '$\partial\Gamma$' \lstAB))
(\print (\memberQ (\list 'abc' :99)  (\list \lstA (\list 'abc' :99) \lstB))) % /t
(\print (\memberQ (\list '$\frac{\xi}{\Omega}$' :999) \lstAB))
\end{verbatim}

\begin{framed}
\noindent
\lispinterp{
(\print (\memberQ '\LaTeX' \lstAB))
(\print (\memberQ :999 \lstAB))
(\print (\memberQ '$\partial\Gamma$' \lstAB))
(\print (\memberQ (\list 'abc' :99)  (\list \lstA (\list 'abc' :99) \lstB))) % /t
(\print (\memberQ (\list '$\frac{\xi}{\Omega}$' :999) \lstAB))
}
\end{framed}


\subsection{pairlis}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \pairlis \x \y \a
%%% Give the list of pairs of corresponding elements of the lists \x and
%%% \y, and appends this to the list \a. The resultant list of pairs, which 
%%% is like a table with two columns, is called an association list. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(\define \lstPL (\pairlis (\list 'A' 'B' 'C') (\list 'U' 'V' 'W') 
   (\list (\cons 'D' 'X') (\cons 'E' 'Y'))))
%(\writeList \lstPL '[' ', ' ']')
(\print \lstPL)
\end{verbatim}

\begin{framed}
\noindent
\lispinterp{
(\define \lstPL (\pairlis (\list 'A' 'B' 'C') (\list 'U' 'V' 'W') 
   (\list (\cons 'D' 'X') (\cons 'E' 'Y'))))
%(\writeList \lstPL '[' ', ' ']')
(\print \lstPL)
}
\end{framed}


\subsection{assoc}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \assoc \x \a
%%% If \a is an association list, then \assoc will produce the first pair 
%%% whose first term is \x. Thus it is a table searching function. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%(\writeList (\assoc 'B' \lstPL) '[' ', ' ']')
(\print (\assoc 'B' \lstPL))
\end{verbatim}

%not good
\begin{framed}
\noindent
\lispinterp{
%(\writeList (\assoc 'B' \lstPL) '[' ', ' ']')
(\print (\assoc 'B' \lstPL))
}
\end{framed}


\subsection{sublis}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \sublis \a \y 
%%% Here \a is assumed to be an association list of the form 
%%% ((ul . v l ) . . . (un . v,)), where the u1's are atomic, and \y is 
%%% any S-expression. What \sublis does, is to treat the u1's as variables 
%%% when they occur in \y, and to substitute the corresponding v1's
%%% from the pair list. 
%%% Note: \sublisXXX is the helper function sub2 in the LISP 1.5 Programmer
%%% Manual (from where we have the info:).
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%(\define \lstSL 
%  (\sublis (\list (\list 'X' 'SHAKESPEARE') (\list 'Y' (\list 'THE TEMPEST'))) 
%      (\list 'X' 'WROTE' 'Y'))
(\writeList (\list (\list 'a' 'b') ) '[' ', ' ']')
\end{verbatim}

% problem is cons?
\begin{framed}
\noindent
\lispinterp{
%(\define \lstSL 
%  (\sublis (\list (\list 'X' 'SHAKESPEARE') (\list 'Y' (\list 'THE TEMPEST'))) 
%      (\list 'X' 'WROTE' 'Y'))
(\writeList (\list (\list 'a' 'b') ) '[' ', ' ']')
}
\end{framed}

\subsection{union}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \union \x \y 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(\define \lstUN (\union (\list 'A' 'B' 'C') (\list 'A' 'X' 'C' 'D'))) 
(\writeList \lstUN '[' ', ' ']')
\end{verbatim}

\begin{framed}
\noindent
\lispinterp{
(\define \lstUN (\union (\list 'A' 'B' 'C') (\list 'A' 'X' 'C' 'D'))) 
(\writeList \lstUN '[' ', ' ']')
}
\end{framed}

\subsection{intersection}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \intersection \x \y 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(\define \lstIN (\intersection (\list 'A' 'B' 'C') (\list 'A' 'X' 'C' 'D'))) 
(\writeList \lstIN '[' ', ' ']')
\end{verbatim}

\begin{framed}
\noindent
\lispinterp{
(\define \lstIN (\intersection (\list 'A' 'B' 'C') (\list 'A' 'X' 'C' 'D'))) 
(\writeList \lstIN '[' ', ' ']')
}
\end{framed}

\subsection{reverse}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \reverse \x  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(\writeList (\reverse \lstA) '[' ', ' ']')
(\texprint '\\')
(\writeList (\reverse \lstB) '[' ', ' ']')
(\texprint '\\')
(\writeList (\reverse \lstAB) '[' ', ' ']')
\end{verbatim}

\begin{framed}
\noindent
\lispinterp{
(\writeList (\reverse \lstA) '[' ', ' ']')
(\texprint '\\')
(\writeList (\reverse \lstB) '[' ', ' ']')
(\texprint '\\')
(\writeList (\reverse \lstAB) '[' ', ' ']')
}
\end{framed}


\subsection{foldr}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \foldr \f \x \y 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(\texprint (\foldr (\lambda (\x \y) (\+ \x \y)) :0 (\list :1 :2 :3)))
(\texprint '\\')
(\texprint (\foldr (\lambda (\x \y) (\+ \x \y)) :1000 (\list :1 :2 :3)))
\end{verbatim}

\begin{framed}
\noindent
\lispinterp{
(\texprint (\foldr (\lambda (\x \y) (\+ \x \y)) :0 (\list :1 :2 :3)))
(\texprint '\\')
(\texprint (\foldr (\lambda (\x \y) (\+ \x \y)) :1000 (\list :1 :2 :3)))
}
\end{framed}

\subsection{foldl}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \foldl \f \x \y 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(\texprint (\foldl (\lambda (\x \y) (\+ \x \y)) :1 (\list :1 :2 :3)))
(\texprint '\\')
(\texprint (\foldl (\lambda (\x \y) (\* \x \y)) :3 (\list :1 :2 :3)))
\end{verbatim}

\begin{framed}
\noindent
\lispinterp{
(\texprint (\foldl (\lambda (\x \y) (\+ \x \y)) :1 (\list :1 :2 :3)))
(\texprint '\\')
(\texprint (\foldl (\lambda (\x \y) (\* \x \y)) :3 (\list :1 :2 :3)))
}
\end{framed}

\subsection{filter}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \filter \f \x 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(\print (\filter (\lambda (\x) (\> \x :3)) (\list :1 :2 :3 :4 :5 :6 :7)))
\end{verbatim}

\begin{framed}
\noindent
\lispinterp{
(\print (\filter (\lambda (\x) (\> \x :3)) (\list :1 :2 :3 :4 :5 :6 :7)))
}
\end{framed}


\subsection{allQ}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \allQ \f \x 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(\print (\allQ (\lambda (\x) (\> \x :3)) (\list :1 :2 :3 :4 :5 :6 :7)))
(\texprint '\\')
(\print (\allQ (\lambda (\x) (\< \x :10)) (\list :1 :2 :3 :4 :5 :6 :7)))
\end{verbatim}

\begin{framed}
\noindent
\lispinterp{
(\print (\allQ (\lambda (\x) (\> \x :3)) (\list :1 :2 :3 :4 :5 :6 :7)))
(\texprint '\\')
(\print (\allQ (\lambda (\x) (\< \x :10)) (\list :1 :2 :3 :4 :5 :6 :7)))
}
\end{framed}


\subsection{anyQ}
\begin{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% \anyQ \f \x 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
(\print (\anyQ (\lambda (\x) (\< \x :3)) (\list :1 :2 :3 :4 :5 :6 :7)))
(\texprint '\\')
(\print (\anyQ (\lambda (\x) (\> \x :10)) (\list :1 :2 :3 :4 :5 :6 :7)))
\end{verbatim}

\begin{framed}
\noindent
\lispinterp{
(\print (\anyQ (\lambda (\x) (\< \x :3)) (\list :1 :2 :3 :4 :5 :6 :7)))
(\texprint '\\')
(\print (\anyQ (\lambda (\x) (\> \x :10)) (\list :1 :2 :3 :4 :5 :6 :7)))
}
\end{framed}

\lispinterp{
(\define \csAB (\cons 'A' 'B'))
(\print (\listQ \csAB)) % should be /f
(\print (\pairQ \csAB))
(\print (\pairQ (\list 'A' 'B' 'C'))) 
(\print \csAB)
}

\end{document}